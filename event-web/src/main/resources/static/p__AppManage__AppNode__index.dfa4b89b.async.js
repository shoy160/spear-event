"use strict";(self.webpackChunkauthing_event_front=self.webpackChunkauthing_event_front||[]).push([[431],{76739:function(U,m,e){e.r(m),e.d(m,{default:function(){return Oe}});var y=e(22786),n=e.n(y),A=e(48651),s=e.n(A),t=e(38046),p=e.n(t),R=e(46299),c=e.n(R),j=e(70300),C=e.n(j),B=e(86516),o=e.n(B),W=e(36378),v=e(20071),J=e(89313),i=e(99920),b=e(55380),re=e(89207),te=e(62111),D=e(30417),Q=e(8278),X=e(34422),oe=e(49599),le=e(5029),pe=e(28306),w=e(36047),ie=e(12270),Re=e(6473),$e=e(54800),Ie=e(55884),Le=e(33588);function k(x,d){return(0,D.request)("/manage/app/openapi/".concat(x,"/publish"),{method:"post",data:d!=null?d:{}})}function de(x){return(0,D.request)("/manage/app/openapi/".concat(x),{method:"get"})}function me(x,d){return(0,D.request)("/manage/app/openapi/".concat(x),{data:d,method:"put"})}var q=e(80702),ce=e(75629),ve=e(18766),_=e(98842),fe=e(79454),he=e(60712),ge=e(88359),u=e(17210),Ee={},Pe={mode:"tags",showArrow:!1,showSearch:!1,open:!1},ye=function(){var d=ge.Z.useForm(),T=o()(d,1),K=T[0],S=(0,D.useParams)(),$=S.appId,G=Q.ZP.useMessage(),N=o()(G,2),I=N[0],z=N[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(he.Y,{title:"\u53D1\u5E03\u5E94\u7528",form:K,trigger:(0,u.jsx)(X.ZP,{type:"primary",children:"\u53D1\u5E03\u5E94\u7528"}),modalProps:{destroyOnClose:!0},onFinish:function(){var H=c()(n()().mark(function L(V){return n()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,k($,V);case 2:return I.success("\u53D1\u5E03\u6210\u529F"),F.abrupt("return",!0);case 4:case"end":return F.stop()}},L)}));return function(L){return H.apply(this,arguments)}}(),autoFocusFirstInput:!0,grid:!0,children:[(0,u.jsx)(i.Z,{label:"\u5E94\u7528\u540D\u79F0",name:"appName",colProps:{span:12},rules:[{required:!0}]}),(0,u.jsx)(i.Z,{label:"\u5E94\u7528\u552F\u4E00\u6807\u8BC6",name:"appCode",colProps:{span:12},rules:[{required:!0}]}),(0,u.jsx)(b.Z,{label:"\u5E94\u7528\u8282\u70B9\u5206\u7C7B",name:"categories",tooltip:"\u56DE\u8F66\u751F\u6210 Tag",colProps:{span:12},rules:[{required:!0}],fieldProps:{mode:"tags",showArrow:!1,showSearch:!1},request:q.u}),(0,u.jsx)(b.Z,{label:"\u5E94\u7528\u8282\u70B9\u5206\u7EC4",name:"groups",tooltip:"\u56DE\u8F66\u751F\u6210 Tag",valueEnum:Ee,colProps:{span:12},fieldProps:Pe}),(0,u.jsx)(i.Z,{label:"\u5E94\u7528 Logo \u5730\u5740",name:"appLogo",colProps:{span:12}})]}),z]})},Ae=(0,w.memo)(ye),je=["status","type","openapi","published"],Ce=["status","type","openapi"],xe={},ee=W.A.Group,Fe=function(){var d=(0,D.useParams)(),T=d.appId,K=(0,D.useOutletContext)(),S=K.data,$=(S==null?void 0:S.type)==="Custom",G=Q.ZP.useMessage(),N=o()(G,2),I=N[0],z=N[1],H=(0,ce.Z)("AppNodeTypeEnum"),L=H.AppNodeTypeEnum,V=(0,_.Z)(),Y=o()(V,2),F=Y[0],ue=Y[1],Ze=ue.setTrue,Be=ue.setFalse,De=(0,_.Z)(),ae=o()(De,2),Me=ae[0],ne=ae[1],be=ne.setTrue,Te=ne.setFalse,se=(0,fe.Z)(k,{manual:!0,onSuccess:function(){I.success("\u53D1\u5E03\u6210\u529F")}}),Se=se.run,Ne=se.loading;return(0,u.jsxs)(v.Z,{children:[(0,u.jsxs)(W.A,{submitter:{searchConfig:{submitText:"\u4FDD\u5B58"},render:function(f,a){return $?[].concat(C()(a),[Me?(0,u.jsx)(X.ZP,{type:"primary",onClick:Ze,children:"\u53D1\u5E03\u5E94\u7528"},"PublishAppBtn"):(0,u.jsx)(Ae,{},"PublishAppModal")]):a}},request:c()(n()().mark(function O(){var f,a,h,r,g,Z,E;return n()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,de(T);case 2:return f=P.sent,a=f.data,h=a.status,r=a.type,g=a.openapi,Z=a.published,E=p()(a,je),(0,le.Z)(Z)?Te():be(),P.abrupt("return",s()(s()({},E),{},{status:h==="Enabled",type:r!=null?r:"Custom",openapi:JSON.stringify(g,null,2)}));case 7:case"end":return P.stop()}},O)})),onFinish:function(){var O=c()(n()().mark(function f(a){var h,r,g,Z,E,M;return n()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return h=a.status,r=a.type,g=a.openapi,Z=p()(a,Ce),E=s()(s()({},Z),{},{type:r,status:h?"Enabled":"Disabled"}),M=r==="OpenApi"?s()(s()({},E),{},{openapi:g}):E,l.next=5,me(T,M);case 5:I.success("\u4FDD\u5B58\u6210\u529F");case 6:case"end":return l.stop()}},f)}));return function(f){return O.apply(this,arguments)}}(),grid:!0,children:[(0,u.jsx)(J.Z,{name:"status",checkedChildren:"\u5F00\u542F",unCheckedChildren:"\u5173\u95ED",fieldProps:{autoFocus:!1}}),(0,u.jsx)(i.Z,{name:"title",label:"\u5E94\u7528\u8282\u70B9\u6807\u9898",colProps:{span:12},rules:[{required:!0}]}),(0,u.jsxs)(ee,{children:[(0,u.jsx)(b.Z,{name:"categories",label:"\u5E94\u7528\u8282\u70B9\u5206\u7C7B",tooltip:"\u56DE\u8F66\u751F\u6210 Tag",colProps:{span:12},rules:$?void 0:[{required:!0}],fieldProps:{mode:"tags",showArrow:!1,showSearch:!1},request:q.u}),(0,u.jsx)(b.Z,{name:"groups",label:"\u5E94\u7528\u8282\u70B9\u5206\u7EC4",tooltip:"\u56DE\u8F66\u751F\u6210 Tag",valueEnum:xe,colProps:{span:12},fieldProps:{mode:"tags",showArrow:!1,showSearch:!1,open:!1}})]}),(0,u.jsx)(ee,{children:(0,u.jsx)(b.Z,{name:"type",label:"\u5E94\u7528\u8282\u70B9\u7C7B\u578B",valueEnum:(0,ve.g)(L),colProps:{span:12},rules:[{required:!0}]})}),(0,u.jsx)(re.Z,{name:["type"],children:function(f){var a=f.type;if(a==="OpenApi")return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(i.Z,{name:"documentUrl",label:"\u6587\u6863\u5730\u5740",colProps:{span:12}}),(0,u.jsx)(i.Z,{name:"debugUrl",label:"\u8C03\u8BD5\u5730\u5740",colProps:{span:12}}),(0,u.jsx)(te.Z,{name:"openapi",label:"OpenApi \u63A5\u53E3\u6570\u636E",className:"w-full",tooltip:"JSON \u6570\u636E",validateFirst:!0,transform:function(r){return{openapi:JSON.parse(r)}},rules:[{required:!0},{validator:function(){var h=c()(n()().mark(function g(Z,E){var M;return n()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(M=JSON.parse(E),(0,pe.Z)(M)){l.next=3;break}return l.abrupt("return",Promise.reject("\u975E\u5BF9\u8C61"));case 3:case"end":return l.stop()}},g)}));function r(g,Z){return h.apply(this,arguments)}return r}(),message:"\u8BF7\u8F93\u5165\u5408\u6CD5\u7684 JSON \u6570\u636E\u683C\u5F0F"}],children:(0,u.jsx)(ie.ZP,{mode:"json",placeholder:"\u8BF7\u8F93\u5165 JSON \u683C\u5F0F\u7684\u6570\u636E",width:"100%",height:"460px",theme:"eclipse",name:"openApiJSON",className:"rounded",fontSize:14,minLines:6,editorProps:{$blockScrolling:!0},setOptions:{useWorker:!1,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!0,showLineNumbers:!0,tabSize:2}})})]})}})]}),(0,u.jsx)(oe.Z,{title:"\u53D1\u5E03\u5E94\u7528",open:F,confirmLoading:Ne,onOk:function(){Se(T)},onCancel:Be,children:(0,u.jsx)("div",{className:"my-5",children:"\u786E\u5B9A\u53D1\u5E03\u6539\u5E94\u7528"})}),z]})},Oe=(0,w.memo)(Fe)},80702:function(U,m,e){e.d(m,{u:function(){return c}});var y=e(22786),n=e.n(y),A=e(46299),s=e.n(A),t=e(58841),p=e(30417);function R(j){return(0,p.request)("/manage/config",{params:j})}var c=function(){var j=s()(n()().mark(function C(){var B,o;return n()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,R({key:"app_node.categories"});case 2:return B=v.sent,o=B.data,v.abrupt("return",(0,t.Z)(o,function(J){var i=J.name;return{label:i,value:i}}));case 5:case"end":return v.stop()}},C)}));return function(){return j.apply(this,arguments)}}()},75629:function(U,m,e){var y=e(30417),n=e(71019),A=function(t){var p=(0,y.useModel)("useEnum");return t!=null&&t.length?(0,n.Z)(p,t):p};m.Z=A},18766:function(U,m,e){e.d(m,{g:function(){return p}});var y=e(5677),n=e.n(y),A=e(48651),s=e.n(A),t=e(76859),p=function(c){return(0,t.Z)(c,function(j,C){var B=C.key,o=C.value;return s()(s()({},j),{},n()({},B,o))},{})}}}]);
