"use strict";(self.webpackChunkauthing_event_front=self.webpackChunkauthing_event_front||[]).push([[824],{83956:function(X,E,e){e.d(E,{G:function(){return h}});var Z=e(30417);function h(y){return(0,Z.request)("/manage/app/list",{params:y})}},89900:function(X,E,e){e.d(E,{s:function(){return h}});var Z=e(30417);function h(y){return(0,Z.request)("/manage/event/".concat(y),{method:"get"})}},26323:function(X,E,e){e.d(E,{X:function(){return m}});var Z=e(48651),h=e.n(Z),y=e(30417);function m(G,D){return(0,y.request)("/manage/event",h()(h()({},D),{},{params:G}))}},6415:function(X,E,e){e.d(E,{Y:function(){return h}});var Z=e(30417);function h(y){return(0,Z.request)("/manage/group/list",{params:y})}},62535:function(X,E,e){e.r(E),e.d(E,{default:function(){return it}});var Z=e(5677),h=e.n(Z),y=e(22786),m=e.n(y),G=e(46299),D=e.n(G),q=e(86516),T=e.n(q),b=e(48651),v=e.n(b),U=e(2972),Y=e(86043),ne=e(16488),i=e(30417),B=e(79454),K=e(7243),fe=e(666),xe=e(94025),_=e(8278),Oe=e(16281),De=e(2804),ae=e(34422),Re=e(76859),Ie=e(5029),re=e(58841),pe=e(36079),Te=e(39588),N=e(36047),se=e(790),he=e(83956);function Ae(x){return(0,i.request)("/manage/event/".concat(x),{method:"delete"})}var Be=e(26323);function Me(x,u){return(0,i.request)("/manage/event/".concat(x,"/extend"),{method:"put",params:u})}var Ee=e(6415),Se=e(12271),ye=e(73355),Fe=e(78868),ge=e(152),t=e(17210),Le=function(u){var R=u.logo,F=u.name,W=u.code;return(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{children:(0,t.jsx)(Fe.Z,{src:R!=null?R:ge,fallback:ge,style:{width:"30px"}})}),(0,t.jsxs)("div",{className:"ml-1 w-full",children:[(0,t.jsx)("p",{className:"m-0 p-0 Truncate ",children:F}),(0,t.jsx)("p",{className:"text-xs m-0 p-0 text-gray-400 Truncate ",children:W})]})]})},be=(0,N.memo)(Le);function Ue(x,u){return(0,i.request)("/manage/event/".concat(x,"/options"),{data:u,method:"put"})}var Ke=e(98842),We=e(21230),$e=e(5507),Ge=function(u){var R=u.id,F=u.checked,W=(0,Ke.Z)(F),M=T()(W,2),g=M[0],$=M[1],H=$.set,J=$.toggle;(0,We.Z)(function(){H(F)},[F]);var Q=(0,B.Z)(Ue,{manual:!0,onSuccess:function(){J(),_.ZP.success("\u66F4\u6539\u6210\u529F\uFF01")}}),w=Q.run,ee=Q.loading,k=(0,K.Z)(function(V){w(R,{options:V?1:0,add:V})});return(0,t.jsx)($e.Z,{loading:ee,checked:g,onClick:k},"isAppOn")},Ne=(0,N.memo)(Ge),Ve=e(24160),Pe=e(75629),je=e(18766),ze=e(49214),Xe=e(38046),Ye=e.n(Xe),He=e(36378),Je=e(46955),ue=e(99920),oe=e(55380),le=e(77965),Qe=e(3758),we=e(49599),ie=e(40466),de=e(82921);function ke(x,u){return(0,i.request)("/manage/event/".concat(x),{method:"put",data:u})}function qe(x){return(0,i.request)("/manage/event",{method:"post",data:x})}var _e=e(89900),et=["eventId","actionRef","onCancel"],tt={},Ce={type:"Public",partition:1,retention:30},nt=function(u){var R=u.eventId,F=u.actionRef,W=u.onCancel,M=Ye()(u,et),g=M.title==="\u7F16\u8F91",$=(0,N.useRef)(null),H=function(){var d;_.ZP.success("".concat(M.title,"\u6210\u529F\uFF01")),W(),(d=F.current)===null||d===void 0||d.reload()},J=(0,B.Z)(qe,{manual:!0,onSuccess:H}),Q=J.run,w=(0,B.Z)(ke,{manual:!0,onSuccess:H}),ee=w.run,k=(0,K.Z)(D()(m()().mark(function I(){var d,c,P,j,C,o,O,S,l,L;return m()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(P=(d=$.current)===null||d===void 0||(c=d.validateFieldsReturnFormatValue)===null||c===void 0?void 0:c.call(d),P){p.next=3;break}return p.abrupt("return");case 3:return p.next=5,(0,de.V)(P);case 5:if(j=p.sent,C=T()(j,2),o=C[0],O=C[1],!(o||!O)){p.next=11;break}return p.abrupt("return");case 11:S=(0,pe.Z)(O),l=S.appCode,L=S.code,l&&(S.code="".concat(l,".").concat(L)),g?ee(R,S):Q(S);case 15:case"end":return p.stop()}},I)}))),V=(0,Pe.Z)("EventTypeEnum"),ce=V.EventTypeEnum,ve=(0,K.Z)(function(){var I=D()(m()().mark(function d(c){var P,j,C,o,O;return m()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(j=c.type,C=c.privateId,(P=$.current)===null||P===void 0||P.setFieldValue("appCode",void 0),o=j==="Public",!(!C&&!o)){l.next=5;break}return l.abrupt("return",[]);case 5:return l.next=7,(0,he.G)({type:o?"System":"Custom",privateId:o?void 0:C});case 7:return O=l.sent,l.abrupt("return",(0,re.Z)(O.data,function(L){var z=L.code,p=L.name;return{label:p,value:z}}));case 9:case"end":return l.stop()}},d)}));return function(d){return I.apply(this,arguments)}}());return(0,t.jsx)(we.Z,v()(v()({},M),{},{onCancel:W,destroyOnClose:!0,width:600,onOk:k,children:(0,t.jsxs)(He.A,{submitter:!1,formRef:$,layout:"horizontal",labelCol:{span:5},request:D()(m()().mark(function I(){var d,c,P,j;return m()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(g){o.next=2;break}return o.abrupt("return",Ce);case 2:return o.next=4,(0,de.V)((0,_e.s)(R));case 4:if(d=o.sent,c=T()(d,2),P=c[0],j=c[1],!P){o.next=8;break}return o.abrupt("return",Ce);case 8:return o.abrupt("return",j.data);case 9:case"end":return o.stop()}},I)})),children:[(0,t.jsx)(Je.Z.Group,{radioType:"button",name:"type",readonly:g,label:"\u4E8B\u4EF6\u7C7B\u578B",fieldProps:{buttonStyle:"solid"},valueEnum:(0,je.g)(ce)}),(0,t.jsx)(ie.ProFormDependency,{name:["type"],children:function(d){var c=d.type;return c==="Private"&&(0,t.jsx)(ue.Z,{name:"privateId",readonly:g,placeholder:"\u7528\u6237\u6C60 ID \u7B49",label:"\u79C1\u6709 ID",rules:[{required:!g,message:"\u8BF7\u8F93\u5165\u79C1\u6709 ID"}]})}}),(0,t.jsx)(oe.Z,{name:"appCode",label:"\u5E94\u7528",readonly:g,dependencies:["type","privateId"],request:ve}),(0,t.jsx)(ie.ProFormDependency,{name:["appCode"],children:function(d){var c=d.appCode;return(0,t.jsx)(ue.Z,{readonly:g,name:"code",label:"\u4E8B\u4EF6\u7F16\u7801",rules:[{required:!g,message:"\u8BF7\u8F93\u5165\u4E8B\u4EF6\u7F16\u7801"}],fieldProps:{addonBefore:c&&"".concat(c,".")}})}}),(0,t.jsx)(ue.Z,{name:"name",label:"\u4E8B\u4EF6\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u4E8B\u4EF6\u540D\u79F0"}]}),(0,t.jsx)(ie.ProFormDependency,{name:["appCode"],children:function(d){var c=d.appCode;return c?(0,t.jsx)(oe.Z,{name:"tags",label:"\u6807\u7B7E",request:D()(m()().mark(function P(){var j,C,o,O;return m()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,de.V)((0,Ee.Y)({type:"Tag",appCode:c}));case 2:if(j=l.sent,C=T()(j,2),o=C[0],O=C[1],!o){l.next=8;break}return l.abrupt("return",[]);case 8:return l.abrupt("return",(0,re.Z)(O==null?void 0:O.data,function(L){var z=L.name;return{label:z,value:z}}));case 9:case"end":return l.stop()}},P)})),fieldProps:{mode:"tags",showArrow:!0,showSearch:!1}}):(0,t.jsx)(oe.Z,{name:"tags",label:"\u6807\u7B7E",valueEnum:tt,fieldProps:{mode:"tags",open:!1}})}}),(0,t.jsx)(le.Z,{name:"sort",label:"Sort"}),(0,t.jsx)(le.Z,{readonly:g,name:"partition",label:"\u5206\u533A\u6570",min:1,rules:[{type:"number"}]}),(0,t.jsx)(le.Z,{readonly:g,name:"retention",label:"\u6570\u636E\u6709\u6548\u671F(\u5929)",min:0,rules:[{type:"number"}]}),(0,t.jsx)(Qe.Z,{name:"desc",label:"\u4E8B\u4EF6\u63CF\u8FF0"})]})}))},at=(0,N.memo)(nt),rt=xe.Z.Link,st=(0,ze.G)(Be.X,{apiOp:{timeout:30*1e3}}),ut={defaultValue:{desc:{show:!1},replications:{show:!1},retention:{show:!1},privateId:{show:!1}}},ot=v()(v()({},ye.mo),{},{collapsed:!1,collapseRender:!1}),lt=function(){var u=(0,N.useRef)(null),R=(0,N.useRef)(!1),F=(0,i.useNavigate)(),W=(0,B.Z)(he.G),M=W.data,g=(0,Pe.Z)("EventTypeEnum"),$=g.EventTypeEnum,H=(0,se.x)({open:!1,text:""}),J=T()(H,2),Q=J[0],w=J[1],ee=(0,se.x)(0),k=T()(ee,2),V=k[0],ce=k[1],ve=(0,se.x)({open:!1,title:"",eventId:0}),I=T()(ve,2),d=I[0],c=I[1],P=(0,K.Z)(function(){c(function(s){s.open=!1})}),j=(0,K.Z)(function(){w(function(s){s.open=!1})}),C=(0,B.Z)(Me,{manual:!0,onSuccess:function(){var n;_.ZP.success("\u4FEE\u6539\u6210\u529F\uFF01"),(n=u.current)===null||n===void 0||n.reload()},onError:function(){_.ZP.error("\u4FEE\u6539\u5931\u8D25\uFF01")}}),o=C.run,O=(0,B.Z)(Ae,{manual:!0,onSuccess:function(){var n;_.ZP.success("\u5220\u9664\u6210\u529F\uFF01"),j(),(n=u.current)===null||n===void 0||n.reload()}}),S=O.run,l=function(){S(V)},L=(0,fe.Z)(function(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"\u4E8B\u4EF6\u5217\u8868"}),(0,t.jsx)(Oe.Z,{title:"\u66F4\u65B0\u6570\u636E",children:(0,t.jsx)(U.Z,{style:{marginLeft:10},onClick:D()(m()().mark(function s(){var n;return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return R.current=!0,r.next=3,(n=u.current)===null||n===void 0?void 0:n.reload();case 3:R.current=!1;case 4:case"end":return r.stop()}},s)}))})})]})},[]),z=(0,B.Z)(Ee.Y,{defaultParams:[{type:"Tag"}]}),p=z.data,dt=(0,fe.Z)(function(){return(0,Re.Z)(p==null?void 0:p.data,function(s,n){var a=n.name;return v()(v()({},s),{},h()({},a,a))},{})},[p]),ct=[{title:"\u4E8B\u4EF6\u7F16\u7801",dataIndex:"code",editable:!1,width:300,fixed:"left",render:function(n,a){var r=a.code,f=a.id;return(0,t.jsx)(rt,{copyable:!0,onClick:function(){return F("/Event/Details/".concat(f,"/Schema"))},ellipsis:!0,children:r})}},{title:"\u5E94\u7528",dataIndex:"app",width:200,editable:!1,search:{transform:function(n){return{appCode:n}}},render:function(n,a){var r=a.app;return r!=null&&r.code?(0,t.jsx)(be,v()({},r)):"-"},valueType:"select",fieldProps:{options:(0,Ve.U)(M==null?void 0:M.data),showSearch:!0}},{title:"\u4E8B\u4EF6\u540D\u79F0",dataIndex:"name",ellipsis:!0,editable:!1,width:200},{title:"\u6807\u7B7E",dataIndex:"tags",editable:!1,valueType:"select",valueEnum:dt,width:150,search:{transform:function(n){return{tag:n}}},render:function(n,a){var r=a.tags;return(0,Ie.Z)(r)?"-":(0,re.Z)(r,function(f,A){return(0,t.jsx)(De.Z,{children:f},A)})}},{title:"\u4E8B\u4EF6\u7C7B\u578B",dataIndex:"type",ellipsis:!0,editable:!1,valueEnum:(0,je.g)($)},{title:"\u79C1\u6709 ID",dataIndex:"privateId",ellipsis:!0,editable:!1,search:{transform:function(n){return{parent:n}}}},{title:"\u4E8B\u4EF6\u63CF\u8FF0",dataIndex:"desc",ellipsis:!0,editable:!1,search:!1},{title:"Sort",dataIndex:"sort",editable:!1,search:!1,sorter:!0},{title:"\u5206\u533A\u6570",dataIndex:"partition",ellipsis:!0,search:!1,valueType:"digit",formItemProps:function(n,a){var r=a.entity;return{rules:[{required:!0},{type:"number",min:r.partition}]}},render:function(n,a,r,f){var A=a.partition,Ze=a.id;return(0,t.jsxs)(t.Fragment,{children:[A,(0,t.jsx)(Y.Z,{style:{color:"#1890ff",marginLeft:6},onClick:function(){var me;f==null||(me=f.startEditable)===null||me===void 0||me.call(f,Ze)}})]})}},{title:"\u526F\u672C\u6570",dataIndex:"replications",ellipsis:!0,search:!1,editable:!1,valueType:"digit"},{title:"\u6D88\u606F\u6570\u91CF",dataIndex:"messageCount",ellipsis:!0,search:!1,editable:!1,valueType:"digit"},{title:"\u6570\u636E\u6709\u6548\u671F(\u5929)",dataIndex:"retention",ellipsis:!0,search:!1,editable:!1,valueType:"digit"},{title:"\u53EF\u7F16\u6392",dataIndex:"options",width:100,search:!1,editable:!1,render:function(n,a){var r=a.id,f=a.options;return(0,t.jsx)(Ne,{id:r,checked:(f&1)===1})}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createdAt",ellipsis:!0,search:!1,editable:!1,valueType:"dateTime",width:160},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:100,fixed:"right",render:function(n,a){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ae.ZP,{type:"link",className:"p-1",onClick:function(){var f=(0,pe.Z)(a);(0,Te.Z)(f.tags)||(f.tags=[]),c(function(A){A.open=!0,A.title="\u7F16\u8F91",A.eventId=a.id})},children:"\u7F16\u8F91"},"edit"),(0,t.jsx)(ae.ZP,{className:"p-1",type:"link",danger:!0,onClick:function(){w(function(f){f.text=a.code,f.open=!0}),ce(a.id)},children:"\u5220\u9664"})]})}}],vt=(0,K.Z)(function(){return[(0,t.jsx)(ae.ZP,{type:"primary",onClick:function(){c(function(n){n.open=!0,n.title="\u65B0\u5EFA"})},children:"\u65B0\u5EFA"},"add")]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ne.Z,{scroll:{x:1900},actionRef:u,rowKey:"id",headerTitle:L,columns:ct,columnsState:ut,request:function(n,a){var r=a.sort;return st(v()(v()({},n),{},{refresh:R.current,sortWay:r}))},editable:{type:"multiple",actionRender:function(n,a,r){return[r.save,r.cancel]},onSave:function(){var s=D()(m()().mark(function a(r,f){var A;return m()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:A=f.partition,o(r,{partitions:A});case 2:case"end":return te.stop()}},a)}));function n(a,r){return s.apply(this,arguments)}return n}()},search:ot,pagination:ye.Xg,toolBarRender:vt}),(0,t.jsx)(at,v()(v()({},d),{},{actionRef:u,onCancel:P})),(0,t.jsx)(Se.Z,v()(v()({},Q),{},{onCancel:j,title:"\u5220\u9664\u4E8B\u4EF6",delOnOk:l,placeholder:"\u8BF7\u8F93\u5165\u4E8B\u4EF6\u7F16\u7801"}))]})},it=(0,N.memo)(lt)},24160:function(X,E,e){e.d(E,{U:function(){return q}});var Z=e(48651),h=e.n(Z),y=e(58841),m=e(52346),G=function(b){return(0,y.Z)(b,function(v){var U=v.name,Y=v.code;return{label:"".concat(U," - ").concat(Y),value:Y}})},D=[{label:"\u7CFB\u7EDF\u5E94\u7528",value:"System"},{label:"\u81EA\u5B9A\u4E49\u5E94\u7528",value:"Custom"}],q=function(b){if(!b)return[];var v=(0,m.Z)(b,"type");return(0,y.Z)(D,function(U){return h()(h()({},U),{},{options:G(v[U.value])})})}},5029:function(X,E,e){var Z=e(56001),h=e(92806),y=e(90285),m=e(39588),G=e(54353),D=e(98787),q=e(1203),T=e(44149),b="[object Map]",v="[object Set]",U=Object.prototype,Y=U.hasOwnProperty;function ne(i){if(i==null)return!0;if((0,G.Z)(i)&&((0,m.Z)(i)||typeof i=="string"||typeof i.splice=="function"||(0,D.Z)(i)||(0,T.Z)(i)||(0,y.Z)(i)))return!i.length;var B=(0,h.Z)(i);if(B==b||B==v)return!i.size;if((0,q.Z)(i))return!(0,Z.Z)(i).length;for(var K in i)if(Y.call(i,K))return!1;return!0}E.Z=ne}}]);
