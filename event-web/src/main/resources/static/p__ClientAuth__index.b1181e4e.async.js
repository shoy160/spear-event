"use strict";(self.webpackChunkauthing_event_front=self.webpackChunkauthing_event_front||[]).push([[896],{78956:function(N,i,e){e.d(i,{c:function(){return r}});var d=e(30417);function r(m){return(0,d.request)("/manage/client",{params:m})}},26323:function(N,i,e){e.d(i,{X:function(){return a}});var d=e(48651),r=e.n(d),m=e(30417);function a(u,f){return(0,m.request)("/manage/event",r()(r()({},f),{},{params:u}))}},43189:function(N,i,e){e.r(i),e.d(i,{default:function(){return Le}});var d=e(86516),r=e.n(d),m=e(48651),a=e.n(m),u=e(36047),f=e(16488),U=e(8278),X=e(19976),D=e(34422),A=e(7243),h=e(79454),C=e(666),B=e(790),ve=e(58841),pe=e(40291),ae=e(22786),L=e.n(ae),J=e(46299),ue=e.n(J),oe=e(5677),S=e.n(oe),se=e(38046),le=e.n(se),Y=e(60712),H=e(46955),j=e(55380),W=e(89207),F=e(99920),O=e(76859),Q=e(36079),w=e(78956),ie=e(26323),k=e(30417);function E(g,o){return(0,k.request)("/manage/client/grant/".concat(g),{data:o,method:"post"})}var ye=e(82921),he=e(75629),de=e(18766),n=e(17210),Ae=["actionRef","onCancel"],Pe=["ProducerAndConsumer","Consumer"],Re=function(o){var q=o.actionRef,T=o.onCancel,ee=le()(o,Ae),M=(0,u.useRef)(),K=(0,he.Z)("eventGrantType"),$=K.eventGrantType,ne=(0,h.Z)(E,{manual:!0,onSuccess:function(){var t;U.ZP.success("\u65B0\u5EFA\u6210\u529F\uFF01"),T(),(t=q.current)===null||t===void 0||t.reload()}}),G=ne.run,te=(0,h.Z)(w.c,{defaultParams:[{size:1e3}]}),P=te.data,I=(0,C.Z)(function(){return(0,O.Z)(P==null?void 0:P.data.list,function(_,t){var l=t.id,R=t.name;return a()(a()({},_),{},S()({},l,R))},{})},[P]),s=(0,h.Z)(ie.X,{manual:!0}),b=s.data,x=s.run,fe=(0,C.Z)(function(){return(0,O.Z)(b==null?void 0:b.data.list,function(_,t){var l=t.code,R=t.name;return a()(a()({},_),{},S()({},l,"".concat(R," - ").concat(l)))},{})},[b]),re=(0,A.Z)(ue()(L()().mark(function _(){var t,l,R,y,V,me,z,_e;return L()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(R=(t=M.current)===null||t===void 0||(l=t.validateFieldsReturnFormatValue)===null||l===void 0?void 0:l.call(t),R){c.next=3;break}return c.abrupt("return");case 3:return c.next=5,(0,ye.V)(R);case 5:if(y=c.sent,V=r()(y,2),me=V[0],z=V[1],!(me||!z)){c.next=11;break}return c.abrupt("return");case 11:_e=(0,Q.Z)(z),G(z.clientId,_e);case 13:case"end":return c.stop()}},_)})));return(0,n.jsxs)(Y.Y,a()(a()({title:"\u5BA2\u6237\u7AEF\u6388\u6743"},ee),{},{formRef:M,layout:"horizontal",labelCol:{span:5},modalProps:{destroyOnClose:!0,onCancel:T},width:600,onFinish:re,children:[(0,n.jsx)(H.Z.Group,{initialValue:"Producer",radioType:"button",name:"type",label:"\u6388\u6743\u7C7B\u578B",fieldProps:{buttonStyle:"solid"},valueEnum:(0,de.g)($)}),(0,n.jsx)(j.Z,{name:"clientId",label:"\u5BA2\u6237\u7AEF",valueEnum:I,rules:[{required:!0}]}),(0,n.jsx)(j.Z,{name:"patternType",label:"\u6388\u6743\u6A21\u5F0F",valueEnum:{Literal:"\u7CBE\u786E\u6A21\u5F0F",Prefixed:"\u524D\u7F00\u6A21\u5F0F"},rules:[{required:!0}],fieldProps:{onChange:function(t){t==="Literal"&&x({size:1e3})}}}),(0,n.jsx)(W.Z,{name:["patternType"],children:function(t){var l=t.patternType;return l==="Literal"?(0,n.jsx)(j.Z,{name:"topics",label:"\u6388\u6743\u4E8B\u4EF6",valueEnum:fe,rules:[{required:!0}],showSearch:!0,debounceTime:500,fieldProps:{mode:"tags"}}):(0,n.jsx)(j.Z,{name:"topics",label:"\u6388\u6743\u7F16\u7801",rules:[{required:!0}],valueEnum:{},fieldProps:{mode:"tags",open:!1}})}}),(0,n.jsx)(W.Z,{name:["type"],children:function(t){var l=t.type;return(0,n.jsx)(F.Z,{name:"group",label:"\u6388\u6743\u5206\u7EC4",rules:[{required:Pe.includes(l)}]})}}),(0,n.jsx)(F.Z,{name:"host",label:"\u6388\u6743\u4E3B\u673A",initialValue:"*"}),(0,n.jsx)(F.Z,{name:"source",label:"\u6388\u6743\u6E90"})]}))},Te=(0,u.memo)(Re),Ee=e(73355);function De(g){return(0,k.request)("/manage/client/grant",{params:g})}var Ce=e(49214);function je(g){return(0,k.request)("/manage/client/grant/".concat(g),{method:"delete"})}var Oe=e(12270),We=e(6473),Fe=e(33588),Ke=e(55884);function Me(g){return(0,k.request)("/manage/client/grant",{data:g,method:"post"})}var Ie=function(o){var q=o.open,T=o.onCancel,ee=o.actionRef,M=(0,B.x)(""),K=r()(M,2),$=K[0],ne=K[1],G=(0,h.Z)(Me,{manual:!0,onSuccess:function(){var s;U.ZP.success("\u64CD\u4F5C\u6210\u529F\uFF01"),T(),(s=ee.current)===null||s===void 0||s.reload()}}),te=G.run,P=function(){var I=ue()(L()().mark(function s(){return L()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:te(JSON.parse($));case 1:case"end":return x.stop()}},s)}));return function(){return I.apply(this,arguments)}}();return(0,n.jsx)(Y.Y,{width:800,title:"\u4E00\u952E\u6388\u6743",open:q,modalProps:{onCancel:T},onFinish:P,children:(0,n.jsx)(Oe.ZP,{mode:"json",width:"100%",height:"600px",theme:"eclipse",showPrintMargin:!1,name:"auth",onChange:function(s){ne(s)},editorProps:{$blockScrolling:!0},setOptions:{useWorker:!1}})})},be=(0,u.memo)(Ie),xe=a()(a()({},Ee.mo),{},{collapsed:!1,collapseRender:!1}),Ze=(0,Ce.G)(De),Ue={defaultValue:{source:{show:!1},status:{show:!1},updatedAt:{show:!1}}},Be=function(){var o=(0,u.useRef)(null),q=(0,B.x)(!1),T=r()(q,2),ee=T[0],M=T[1],K=(0,B.x)({}),$=r()(K,2),ne=$[0],G=$[1],te=(0,B.x)(!1),P=r()(te,2),I=P[0],s=P[1],b=(0,A.Z)(function(){s(!1)}),x=(0,h.Z)(je,{manual:!0,onSuccess:function(){var p;U.ZP.success("\u53D6\u6D88\u6210\u529F\uFF01"),(p=o.current)===null||p===void 0||p.reload()}}),fe=x.run,re=(0,he.Z)(["eventGrantType","StatusEnum","ResourcePatternEnum"]),_=re.eventGrantType,t=re.StatusEnum,l=re.ResourcePatternEnum,R=(0,h.Z)(w.c),y=R.data,V=(0,C.Z)(function(){return{clientName:(0,ve.Z)(y==null?void 0:y.data.list,function(v){var p=v.id,Z=v.name;return{name:Z,id:p}}),clientIdOption:(0,ve.Z)(y==null?void 0:y.data.list,function(v){var p=v.id,Z=v.name;return{label:Z,value:p}})}},[y]),me=V.clientIdOption,z=V.clientName,_e=[{title:"\u6388\u6743\u7C7B\u578B",dataIndex:"type",ellipsis:!0,valueType:"select",valueEnum:(0,de.g)(_),search:{transform:function(p){return{grantType:p}}}},{title:"\u5BA2\u6237\u7AEF ID",dataIndex:"clientId",width:180,search:!1,copyable:!0},{title:"\u5BA2\u6237\u7AEF",dataIndex:"clientId",width:180,hideInTable:!0,valueType:"select",fieldProps:{options:me}},{title:"\u5BA2\u6237\u7AEF\u540D\u79F0",dataIndex:"clientName",ellipsis:!0,search:!1,renderText:function(p,Z){var ce,Se=Z.clientId;return(ce=(0,pe.Z)(z,["id",Se]))===null||ce===void 0?void 0:ce.name}},{title:"\u6388\u6743\u6A21\u5F0F",dataIndex:"patternType",ellipsis:!0,valueType:"select",valueEnum:(0,de.g)(l)},{title:"\u6388\u6743\u7F16\u7801",dataIndex:"topic",ellipsis:!0,search:!1},{title:"\u6388\u6743\u5206\u7EC4",dataIndex:"group",ellipsis:!0,search:!1,copyable:!0},{title:"\u6388\u6743\u6E90",dataIndex:"source",ellipsis:!0,search:!1},{title:"\u6388\u6743\u72B6\u6001",dataIndex:"status",ellipsis:!0,valueType:"select",valueEnum:(0,de.g)(t)},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createdAt",valueType:"dateTime",ellipsis:!0,search:!1},{title:"\u4FEE\u6539\u65F6\u95F4",dataIndex:"updatedAt",ellipsis:!0,search:!1,valueType:"dateTime"},{title:"\u64CD\u4F5C",valueType:"option",key:"option",render:function(p,Z){return[(0,n.jsx)(X.Z,{title:"\u786E\u5B9A\u8981\u53D6\u6D88\u6388\u6743\u5417?",okText:"\u662F",cancelText:"\u5426",onConfirm:function(){fe(Z.id)},children:(0,n.jsx)(D.ZP,{type:"link",danger:!0,children:"\u53D6\u6D88\u6388\u6743"})},"delete")]}}],ge=(0,A.Z)(function(){M(!1),G({})}),c=(0,A.Z)(function(){return[(0,n.jsx)(D.ZP,{type:"primary",onClick:function(){s(!0)},children:"\u4E00\u952E\u6388\u6743"},"auth"),(0,n.jsx)(D.ZP,{type:"primary",onClick:function(){M(!0),G({})},children:"\u65B0\u5EFA"},"add")]});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.Z,{columns:_e,actionRef:o,request:Ze,rowKey:"id",search:xe,pagination:Ee.Xg,headerTitle:"\u5BA2\u6237\u7AEF\u6388\u6743\u5217\u8868",toolBarRender:c,columnsState:Ue}),(0,n.jsx)(Te,{open:ee,actionRef:o,initialValues:ne,onCancel:ge}),(0,n.jsx)(be,{open:I,onCancel:b,actionRef:o})]})},Le=(0,u.memo)(Be)},75629:function(N,i,e){var d=e(30417),r=e(71019),m=function(u){var f=(0,d.useModel)("useEnum");return u!=null&&u.length?(0,r.Z)(f,u):f};i.Z=m},18766:function(N,i,e){e.d(i,{g:function(){return f}});var d=e(5677),r=e.n(d),m=e(48651),a=e.n(m),u=e(76859),f=function(X){return(0,u.Z)(X,function(D,A){var h=A.key,C=A.value;return a()(a()({},D),{},r()({},h,C))},{})}},49214:function(N,i,e){e.d(i,{G:function(){return B}});var d=e(22786),r=e.n(d),m=e(86516),a=e.n(m),u=e(48651),f=e.n(u),U=e(38046),X=e.n(U),D=e(46299),A=e.n(D),h=e(82921),C=["current","pageSize"],B=function(pe){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},L=ae.apiOp,J=ae.originResFn;return function(){var ue=A()(r()().mark(function oe(S){var se,le,Y,H,j,W,F,O,Q,w,ie;return r()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return se=S.current,le=S.pageSize,Y=X()(S,C),H=f()({page:se,size:le},Y),E.next=4,(0,h.V)(pe(H,L));case 4:if(j=E.sent,W=a()(j,2),F=W[0],O=W[1],!(F||!O)){E.next=10;break}return E.abrupt("return",{data:[],success:!1});case 10:return J==null||J(O,H),Q=O.data,w=Q.list,ie=Q.total,E.abrupt("return",{data:w,success:!0,total:ie});case 14:case"end":return E.stop()}},oe)}));return function(oe){return ue.apply(this,arguments)}}()}}}]);
